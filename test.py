from resp.apis.acm_api import ACM
from resp.apis.ieee_api import IEEE
from resp.apis.scholar_api import Scholar
from resp.apis.trends_api import Trends
from pytrends.request import TrendReq
import random
import csv
import json
from db_paper import db_paper
from datetime import datetime
#"Computing methodologies","Computer graphics","Machine learning","Power and energy","Hardware"

#pytrends = TrendReq(hl='pt-Br', tz=360, timeout=(10, 25), retries=0, backoff_factor=0)
#pytrends.build_payload(kw_list=["Computer graphics"], timeframe=['2004-01-01 2021-12-31'])
result =json.loads('{"Computer graphics":{"1072915200000":95,"1075593600000":89,"1078099200000":100,"1080777600000":85,"1083369600000":83,"1086048000000":75,"1088640000000":66,"1091318400000":80,"1093996800000":82,"1096588800000":80,"1099267200000":67,"1101859200000":72,"1104537600000":69,"1107216000000":65,"1109635200000":62,"1112313600000":58,"1114905600000":57,"1117584000000":56,"1120176000000":46,"1122854400000":50,"1125532800000":58,"1128124800000":52,"1130803200000":54,"1133395200000":49,"1136073600000":48,"1138752000000":49,"1141171200000":48,"1143849600000":41,"1146441600000":40,"1149120000000":38,"1151712000000":39,"1154390400000":37,"1157068800000":45,"1159660800000":41,"1162339200000":38,"1164931200000":37,"1167609600000":37,"1170288000000":36,"1172707200000":35,"1175385600000":34,"1177977600000":34,"1180656000000":30,"1183248000000":34,"1185926400000":37,"1188604800000":36,"1191196800000":34,"1193875200000":34,"1196467200000":32,"1199145600000":34,"1201824000000":33,"1204329600000":32,"1207008000000":31,"1209600000000":31,"1212278400000":26,"1214870400000":30,"1217548800000":33,"1220227200000":34,"1222819200000":32,"1225497600000":31,"1228089600000":33,"1230768000000":31,"1233446400000":32,"1235865600000":30,"1238544000000":29,"1241136000000":31,"1243814400000":29,"1246406400000":29,"1249084800000":33,"1251763200000":33,"1254355200000":33,"1257033600000":34,"1259625600000":32,"1262304000000":33,"1264982400000":33,"1267401600000":32,"1270080000000":29,"1272672000000":28,"1275350400000":27,"1277942400000":28,"1280620800000":31,"1283299200000":30,"1285891200000":29,"1288569600000":30,"1291161600000":29,"1293840000000":31,"1296518400000":29,"1298937600000":28,"1301616000000":28,"1304208000000":27,"1306886400000":26,"1309478400000":27,"1312156800000":31,"1314835200000":32,"1317427200000":26,"1320105600000":31,"1322697600000":31,"1325376000000":30,"1328054400000":31,"1330560000000":28,"1333238400000":28,"1335830400000":30,"1338508800000":26,"1341100800000":27,"1343779200000":30,"1346457600000":28,"1349049600000":27,"1351728000000":28,"1354320000000":26,"1356998400000":27,"1359676800000":30,"1362096000000":28,"1364774400000":26,"1367366400000":26,"1370044800000":25,"1372636800000":25,"1375315200000":30,"1377993600000":28,"1380585600000":27,"1383264000000":29,"1385856000000":29,"1388534400000":27,"1391212800000":27,"1393632000000":27,"1396310400000":26,"1398902400000":23,"1401580800000":24,"1404172800000":25,"1406851200000":27,"1409529600000":28,"1412121600000":25,"1414800000000":30,"1417392000000":26,"1420070400000":24,"1422748800000":27,"1425168000000":26,"1427846400000":25,"1430438400000":25,"1433116800000":23,"1435708800000":21,"1438387200000":25,"1441065600000":25,"1443657600000":23,"1446336000000":27,"1448928000000":26,"1451606400000":23,"1454284800000":23,"1456790400000":22,"1459468800000":21,"1462060800000":20,"1464739200000":21,"1467331200000":19,"1470009600000":21,"1472688000000":21,"1475280000000":21,"1477958400000":24,"1480550400000":22,"1483228800000":20,"1485907200000":21,"1488326400000":21,"1491004800000":23,"1493596800000":20,"1496275200000":17,"1498867200000":18,"1501545600000":19,"1504224000000":20,"1506816000000":19,"1509494400000":24,"1512086400000":23,"1514764800000":18,"1517443200000":20,"1519862400000":22,"1522540800000":22,"1525132800000":21,"1527811200000":16,"1530403200000":16,"1533081600000":18,"1535760000000":20,"1538352000000":19,"1541030400000":21,"1543622400000":21,"1546300800000":18,"1548979200000":21,"1551398400000":20,"1554076800000":20,"1556668800000":20,"1559347200000":15,"1561939200000":15,"1564617600000":16,"1567296000000":18,"1569888000000":18,"1572566400000":22,"1575158400000":20,"1577836800000":19,"1580515200000":18,"1583020800000":19,"1585699200000":19,"1588291200000":18,"1590969600000":15,"1593561600000":16,"1596240000000":17,"1598918400000":23,"1601510400000":18,"1604188800000":18,"1606780800000":20,"1609459200000":18,"1612137600000":21,"1614556800000":22,"1617235200000":16,"1619827200000":16,"1622505600000":17,"1625097600000":16,"1627776000000":16,"1630454400000":17,"1633046400000":17,"1635724800000":18,"1638316800000":20},"isPartial":{"1072915200000":false,"1075593600000":false,"1078099200000":false,"1080777600000":false,"1083369600000":false,"1086048000000":false,"1088640000000":false,"1091318400000":false,"1093996800000":false,"1096588800000":false,"1099267200000":false,"1101859200000":false,"1104537600000":false,"1107216000000":false,"1109635200000":false,"1112313600000":false,"1114905600000":false,"1117584000000":false,"1120176000000":false,"1122854400000":false,"1125532800000":false,"1128124800000":false,"1130803200000":false,"1133395200000":false,"1136073600000":false,"1138752000000":false,"1141171200000":false,"1143849600000":false,"1146441600000":false,"1149120000000":false,"1151712000000":false,"1154390400000":false,"1157068800000":false,"1159660800000":false,"1162339200000":false,"1164931200000":false,"1167609600000":false,"1170288000000":false,"1172707200000":false,"1175385600000":false,"1177977600000":false,"1180656000000":false,"1183248000000":false,"1185926400000":false,"1188604800000":false,"1191196800000":false,"1193875200000":false,"1196467200000":false,"1199145600000":false,"1201824000000":false,"1204329600000":false,"1207008000000":false,"1209600000000":false,"1212278400000":false,"1214870400000":false,"1217548800000":false,"1220227200000":false,"1222819200000":false,"1225497600000":false,"1228089600000":false,"1230768000000":false,"1233446400000":false,"1235865600000":false,"1238544000000":false,"1241136000000":false,"1243814400000":false,"1246406400000":false,"1249084800000":false,"1251763200000":false,"1254355200000":false,"1257033600000":false,"1259625600000":false,"1262304000000":false,"1264982400000":false,"1267401600000":false,"1270080000000":false,"1272672000000":false,"1275350400000":false,"1277942400000":false,"1280620800000":false,"1283299200000":false,"1285891200000":false,"1288569600000":false,"1291161600000":false,"1293840000000":false,"1296518400000":false,"1298937600000":false,"1301616000000":false,"1304208000000":false,"1306886400000":false,"1309478400000":false,"1312156800000":false,"1314835200000":false,"1317427200000":false,"1320105600000":false,"1322697600000":false,"1325376000000":false,"1328054400000":false,"1330560000000":false,"1333238400000":false,"1335830400000":false,"1338508800000":false,"1341100800000":false,"1343779200000":false,"1346457600000":false,"1349049600000":false,"1351728000000":false,"1354320000000":false,"1356998400000":false,"1359676800000":false,"1362096000000":false,"1364774400000":false,"1367366400000":false,"1370044800000":false,"1372636800000":false,"1375315200000":false,"1377993600000":false,"1380585600000":false,"1383264000000":false,"1385856000000":false,"1388534400000":false,"1391212800000":false,"1393632000000":false,"1396310400000":false,"1398902400000":false,"1401580800000":false,"1404172800000":false,"1406851200000":false,"1409529600000":false,"1412121600000":false,"1414800000000":false,"1417392000000":false,"1420070400000":false,"1422748800000":false,"1425168000000":false,"1427846400000":false,"1430438400000":false,"1433116800000":false,"1435708800000":false,"1438387200000":false,"1441065600000":false,"1443657600000":false,"1446336000000":false,"1448928000000":false,"1451606400000":false,"1454284800000":false,"1456790400000":false,"1459468800000":false,"1462060800000":false,"1464739200000":false,"1467331200000":false,"1470009600000":false,"1472688000000":false,"1475280000000":false,"1477958400000":false,"1480550400000":false,"1483228800000":false,"1485907200000":false,"1488326400000":false,"1491004800000":false,"1493596800000":false,"1496275200000":false,"1498867200000":false,"1501545600000":false,"1504224000000":false,"1506816000000":false,"1509494400000":false,"1512086400000":false,"1514764800000":false,"1517443200000":false,"1519862400000":false,"1522540800000":false,"1525132800000":false,"1527811200000":false,"1530403200000":false,"1533081600000":false,"1535760000000":false,"1538352000000":false,"1541030400000":false,"1543622400000":false,"1546300800000":false,"1548979200000":false,"1551398400000":false,"1554076800000":false,"1556668800000":false,"1559347200000":false,"1561939200000":false,"1564617600000":false,"1567296000000":false,"1569888000000":false,"1572566400000":false,"1575158400000":false,"1577836800000":false,"1580515200000":false,"1583020800000":false,"1585699200000":false,"1588291200000":false,"1590969600000":false,"1593561600000":false,"1596240000000":false,"1598918400000":false,"1601510400000":false,"1604188800000":false,"1606780800000":false,"1609459200000":false,"1612137600000":false,"1614556800000":false,"1617235200000":false,"1619827200000":false,"1622505600000":false,"1625097600000":false,"1627776000000":false,"1630454400000":false,"1633046400000":false,"1635724800000":false,"1638316800000":false}}')
db = db_paper(host="db", user="root", password="example", db="papersplease")
db.connect()
keys = list(result.keys())

for data in result[keys[0]].keys():
    dt_object = datetime.fromtimestamp(int(data)/1000)
    print(dt_object.year,dt_object.month,result[keys[0]][data])
    db.insert_update_trends(2,dt_object.year,dt_object.month,result[keys[0]][data])
db.close()

